package MusicInstrumentsHomework;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.TreeSet;

import javax.swing.text.PlainDocument;

public class MusicShop {

	private Map<String, MusicInstrument> productsInShop;
	private double availableMoney;

	public MusicShop(double availableMoney) {
		productsInShop = new HashMap<String, MusicInstrument>();
		this.setAvailableMoney(availableMoney);
	}

	void addMusicInstrument(String name, InstrumentType type, double price, int quantity) {
		if (!productsInShop.containsKey(name)) {
			productsInShop.put(name, new MusicInstrument(name, type, price));
			int newQuantityInShop = productsInShop.get(name).getQuantityInShop() + quantity;
			productsInShop.get(name).setQuantityInShop(newQuantityInShop);

		}
	}

	void sellMusicInstrument(String name, int quantityForSale) {
		if ((productsInShop.containsKey(name)) && (productsInShop.get(name).getQuantityInShop() >= quantityForSale)) {
			
			
			System.out.println("Nalichi ot instrument predi prodazba " + "\"" + productsInShop.get(name).getName() + "\" "
					+ productsInShop.get(name).getQuantityInShop());
			productsInShop.get(name).setQuantityInShop(productsInShop.get(name).getQuantityInShop() - quantityForSale);
			availableMoney += productsInShop.get(name).getPrice() * quantityForSale;
		} else {
			//narochno e v cherveno
			System.err.println("Nedostatuchna nalichnost ot posocheniq produkt " + "\""
					+ productsInShop.get(name).getName() + "\"");
		}
//		System.out.println("Ostavashti nalichi sled prodazba ot instrument " + "\"" + productsInShop.get(name).getName()
//				+ "\" " + productsInShop.get(name).getQuantityInShop());
		
	}

	public void instrumentCatalog(String comparatorCondition) {
		System.out.println("Razlichni sortiraniq:");
		Set<MusicInstrument> instrumenti = new TreeSet<MusicInstrument>(comparatorCondition.equals("Type")
				? new InstrumentTypeComparator()
				: comparatorCondition.equals("Name") ? new InstrumentNameComparator()
						: comparatorCondition.equals("PriceAscending") ? new InstrumentPriseAscendingComparator()
								: comparatorCondition.equals("PriceDescending")
										? new InstrumentPriseDescendingComparator() : new InstrumentNameComparator());
		for (String instument : productsInShop.keySet()) {
			instrumenti.add(productsInShop.get(instument));
		}
		for (MusicInstrument instrument : instrumenti) {
			System.out.println(instrument);
		}
	}

	private void nalichnost() {
		System.out.println("Nalichnost sled prodazbi:");
		List<String> nalichnost = new ArrayList<String>();
		for (String instrument : productsInShop.keySet()) {
			nalichnost.add(instrument);
		}

		for (String instrument : nalichnost) {
			if (productsInShop.get(instrument).getQuantityInShop() >= 1) {
				System.out.println("Ot instrument " + productsInShop.get(instrument).getName() + " ima "
						+ productsInShop.get(instrument).getQuantityInShop() + " broiki");
			} else {
				System.out.println("Ot instrument " + productsInShop.get(instrument).getName() + " nqma nalichnost");
			}
		}
	}

	public double getAvailableMoney() {
		return availableMoney;
	}

	public void setAvailableMoney(double availableMoney) {
		if (availableMoney >= 0)
			this.availableMoney = availableMoney;
	}

}
