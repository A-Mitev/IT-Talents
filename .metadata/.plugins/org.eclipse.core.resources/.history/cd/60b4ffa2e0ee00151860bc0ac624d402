package bg.ittalents.servlets;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import bg.ittalents.dao.Dolphin;
import bg.ittalents.dao.DolphinDAO;

@WebServlet("/Dolphin")
public class DolphinServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;

	protected void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		PrintWriter pw = response.getWriter();
		List<Dolphin> dolphins = new DolphinDAO().getAll();

		pw.println("<html> <body>");

		pw.println("<table style='border: 1px solid black;'>");

		for (Dolphin d : dolphins) {
			pw.print("<tr>");

			pw.println("<td style='border: 1px solid black;border-collapse:collapse;'> " + d.getName() + "</td>");
			pw.println("<td style='border: 1px solid black;border-collapse:collapse;'> " + d.getColor() + "</td>");

			pw.print("</tr>");
		}
		pw.println("</table>");
		pw.println("</body> </html>");
		pw.println("<html> <body>");
		pw.println("<form action=\"Dolphin\" method=\"post\">");
		pw.println("<label>Ime</label>");
		pw.println("<input type=\"text\" name=\"ime\"/>");
		pw.println("<label>Color</label>");
		pw.println("<input type=\"text\" name=\"color\"/>");
		pw.println("<input type=\"submit\" value=\"add\">");
		pw.println("<br/>");
		pw.println("</form>");
		pw.println("</table>");

		pw.println("<form action=\"Delete\" method=\"post\">");
		pw.println("<label>Remove Dolphin with name:</label>");
		pw.println("<input type=\"text\" name=\"ime\"/>");
		pw.println("<input type=\"submit\" value=\"delete\">");
		pw.println("</form>");
		pw.println("</body> </html>");
		pw.close();

	}

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException {
		System.out.println("Stigado tuk 1");
		String name1 = request.getParameter("ime");
		String color1 = request.getParameter("color");
		// if((name1 != null & (name1.length()>1)) | (color1 != null &
		// (color1.length()>0))){
		Dolphin dol = new DolphinDAO().putDolphin(name1, color1);
		// }
		System.out.println(request.getParameter("ime") + " " + request.getParameter("color"));
		System.out.println("Stigado tuk 2");
		try {
			doGet(request, response);
			System.out.println("stiga do tuk 3");
		} catch (ServletException e) {
			e.printStackTrace();
		}

	}
}
