package exam;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;


public class TestDbConnection  {

	public void addEmployee(Person person) throws SQLException {
		Connection conn = DBConnection.getInstance().getConnection();
		PreparedStatement prepStatement = conn.prepareStatement("insert into examdb.person" + "(person_id, Name, Tel, city_id, PersonalNumber) VALUES" + "Values (null, ?, ?,?,?)");
		try {
			prepStatement.setString(1, person.getName());
			prepStatement.setString(2, person.getTel());
			prepStatement.setObject(3, person.getAddress());
			prepStatement.setString(4, person.getPersonalNumber());
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public void getEmployee(String name)  {
		Connection conn = DBConnection.getInstance().getConnection();
		try {
			Statement zaqvka = conn.createStatement();
			ResultSet rs = zaqvka.executeQuery("select * from examdb.person");
			while(rs.next()){
				System.out.println(rs.getInt(0) + " " + rs.getString(1) + " " + rs.getString(1));
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
